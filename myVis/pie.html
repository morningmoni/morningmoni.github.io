<!DOCTYPE html>
<html>
<head>

    <script type="text/javascript" src="d3.js"></script>
     <script>
     function sortby(a,b){

        return b.Counts-a.Counts;
     }
    function draw(data) {
        var width = 900;
        var height = 900;

        var curData=data.aaa;
        curData.sort(sortby);
        //number of parts
        var num=7;
        curData=curData.slice(0,num);
        

        for (var i = 0; i < num; i++) {
            document.write(curData[i].Counts);
            document.write(curData[i].Keywords);
            document.write('<br>');
        };
        

        
        var svg = d3.select("body").append("svg")
                                .attr("width",width)
                                .attr("height",height);

        var outerRadius = width / 2;
        var innerRadius = width / 9;
        var circleData = [
           { "cx": width/2, "cy": height/2, "radius": innerRadius-1, "color" : "green" }];
        var circles =svg.selectAll("circle")
                    .data(circleData)
                    .enter()
                    .append("circle");
        var circleAttributes = circles
                                .attr("cx",function(d){return d.cx;})
                                .attr("cy",function(d){return d.cy;})
                                .attr("r",function(d){return d.radius;})
                                .style("fill",function(d){return d.color;});

        var text = svg.selectAll("text")
                                .data(circleData)
                                .enter()
                                .append("text");
        var textLabels = text
                         .attr("x", function(d) { return d.cx-24; })
                         .attr("y", function(d) { return d.cy; })
                         .text( function (d) { return "2013"; })
                         .attr("font-family", "sans-serif")
                         .attr("font-size", "20px")
                         .attr("fill", "black");

        var pie = d3.layout.pie().sort(null).value(function(d){return d.Counts});
        
        
        var arc = d3.svg.arc()
                        .innerRadius(innerRadius)
                        .outerRadius(outerRadius);
        
        var color = d3.scale.category20();
        
        var arcs = svg.selectAll("g")
                      .data(pie(curData))
                      .enter()
                      .append("g")
                      .attr("transform","translate("+outerRadius+","+outerRadius+")");
                      
        arcs.append("path")
            .attr("fill",function(d,i){
                return color(i);
            })
            .attr("d",function(d){
                return arc(d);
            });
        
        arcs.append("text")
            .attr("transform",function(d){
                return "translate(" + arc.centroid(d) + ")";
            })
            .attr("text-anchor","middle")
            .text(function(d){
                return "Terms:"+d.data.Keywords;
                
            });

        arcs.append("text")
            .attr("transform",function(d){
                var tmp=arc.centroid(d);
                tmp[0]+=10;
                tmp[1]+=30;
                return "translate(" + tmp + ")";
            })
            .attr("text-anchor","middle")
            .text(function(d){
                return "Counts:"+d.data.Counts;
            });
        

    }
    </script>
</head>
<body>
    <script>
        d3.json('infocom_03-14.json', draw);
    </script>
</body>
</html>
